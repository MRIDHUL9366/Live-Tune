<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveTunes Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            display: flex;
            background-color: #f5f6fa;
        }

        .sidebar {
            width: 250px;
            height: 100vh;
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            position: fixed;
        }

        .logo {
            font-size: 24px;
            margin-bottom: 30px;
            text-align: center;
        }

        .menu-item {
            padding: 12px;
            margin: 8px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        .menu-item:hover {
            background-color: #34495e;
        }

        .main-content {
            margin-left: 250px;
            padding: 25px;
            width: calc(100% - 250px);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .header-controls {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .logout-btn {
            color: #e74c3c;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .logout-btn:hover {
            color: #c0392b;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            height: 300px;
        }

        .recent-activity {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }

        .booking-list, .notifications {
            background: white;
            padding: 20px;
            border-radius: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .notification-count {
            background: #e74c3c;
            color: white;
            padding: 3px 8px;
            border-radius: 50%;
            font-size: 12px;
        }

        .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .confirmed {
            background: #2ecc71;
            color: white;
        }
        .notifications {
    width: 300px;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    padding: 15px;
    font-family: Arial, sans-serif;
}

.notifications h2 {
    font-size: 18px;
    margin-bottom: 10px;
    color: #333;
    border-bottom: 2px solid #f1f1f1;
    padding-bottom: 5px;
}

.notification-item {
    background: #f9f9f9;
    border-left: 4px solid #007bff;
    padding: 10px;
    margin: 2px 0;
    border-radius: 5px;
}

.notification-item p {
    margin: 0;
    font-size: 14px;
    color: #333;
    font-weight: bold;
}

.notification-item small {
    display: block;
    font-size: 12px;
    color: #666;
    margin-top: 4px;
}
          .back-button {
      margin-top:5px;
      background-color: #0077cc;
      color: white;
      padding:5px 10px;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }

    .back-button:hover {
      background-color: #005fa3;
    }

    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
            <div class="logo">LiveTunes Admin</div>

            <div class="menu-item">
                <a href="{% url 'admin_dashboard' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-home"></i> Dashboard
                </a>
            </div>

            <div class="menu-item">
                <a href="{% url 'manage_users' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-users"></i> Manage Users
                </a>
            </div>

            <div class="menu-item">
                <a href="{% url 'manage_vendor' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-store"></i> Manage Vendors
                </a>
            </div>

            <div class="menu-item">
                <a href="{% url 'manage_booking' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-calendar-check"></i> Manage Bookings
                </a>
            </div>

            <div class="menu-item">
                <a href="{% url 'payment_refund' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-wallet"></i> Payments & Refunds
                </a>
            </div>



            <div class="menu-item">
                <a href="{% url 'service_management' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-cog"></i> Service Management
                </a>
            </div>

            <div class="menu-item">
                <a href="{% url 'add_announcement' %}" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-comments"></i> Announcement
                </a>
            </div>


            <!--<div class="menu-item">
                <a href="#" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-user-cog"></i> Settings
                </a>
            </div>--->
        </div>


    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <h1>Dashboard Overview</h1>
            <div class="header-controls">
               <!--- <div class="notification-icon">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count">3</span>
                </div>--->
                <div class="logout-btn" onclick="handleLogout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-container">
            <div class="stat-card">
                <h3>Total Bookings</h3>
                <p class="stat-value">{{total_bookings}}</p>
            </div>
            <div class="stat-card">
                <h3>Active Users</h3>
                <p class="stat-value">{{total_users}}</p>
            </div>
            <div class="stat-card">
                <h3>Active Vendors</h3>
                <p class="stat-value">{{total_vendors}}</p>
            </div>
            <div class="stat-card">
                <h3>Revenue</h3>
                <p class="stat-value">{{total_amount.total_earnings}}</p>
            </div>
        </div>

        <!-- Modified Chart Container -->
        <div class="chart-container" style="position: relative; padding-bottom: 50px;">
            <canvas id="monthlyRevenueChart"></canvas>

            <!-- Red Instructions -->
            <div style="position: absolute; bottom: 15px; left: 20px; right: 20px; display: flex; justify-content: space-between; color: #e74c3c; font-size: 14px;">
                <div>
                    <i class="fas fa-info-circle"></i>
                    shows each month's contribution to the overall revenue
                </div>
                <div>
                   <button class="back-button" onclick="window.location.href='{% url 'monthly_chart' %}'">View More</button>
                </div>
            </div>
        </div>



        <!-- Recent Activity -->
        <div class="recent-activity">
            <div class="booking-list">
                <h2>Recent Bookings</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Event</th>
                            <th>User</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for i in latest_booking %}
                        <tr>
                            <td>{{i.event_name}}</td>
                            <td>{{i.user.first_name}}</td>
                            <td>{{i.booking_date}}</td>
                            <td><span class="status confirmed">{{i.vendor_approval}}</span></td>
                        </tr>
                    {% endfor %}

                    </tbody>
                </table>
            </div>

           <div class="notifications">
                <h2>Notifications</h2>
               {% for not in notification %}
                <div class="notification-item">
                    <p>{{not.message}}</p>
                    <small>{{not.created_at}}</small>
                </div>
               {% endfor %}

            </div>
        </div>
    </div>

    <script>
                // Updated Chart Configuration
    const monthlyRevCtx = document.getElementById('monthlyRevenueChart').getContext('2d');
    new Chart(monthlyRevCtx, {
        type: 'bar',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                     'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
                label: 'Monthly Revenue',
                data: {{ monthly_earnings|safe }},
                backgroundColor: '#3498db',
                borderColor: '#2980b9',
                borderWidth: 1,
                barThickness: 34, // Reduced bar width
                categoryPercentage: 0.4 // Adjust spacing between bars
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Amount ($)'
                    },
                    ticks: {
                        callback: function(value) {
                            return '$' + value;
                        }
                    },
                    grid: {
                        color: '#f1f1f1'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Months'
                    },
                    grid: {
                        display: false
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: '#2c3e50',
                    bodyColor: '#ffffff',
                    titleColor: '#ffffff',
                    callbacks: {
                        label: function(context) {
                            return ' Earnings: $' + context.raw;
                        }
                    }
                }
            }
        }
    });
        // Logout Handler
       function handleLogout() {
    window.location.href = "{% url 'logout' %}";
    }

    </script>
</body>
</html>